{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% load prices %}

{% block body_class %}page light{% endblock %}

{% block content %}
<section class="content">
    <div class="row">
        <div class="wrap">
            <h1 class="section-title min-m">{% block title %}{% trans "Discover Weblate" %}{% endblock %}</h1>
            <div class="page-desc">
              <p>
                {% block description %}
                  {% blocktrans %}Discover who is using Weblate, and contribute to your favorite projects.{% endblocktrans %}
                {% endblock %}
              </p>
              <a href="{% url 'user' %}" class="button inline">{% trans "Manage your services" %}</a>
              <form class="form-inline" action="{% url 'discover' %}">
                <input type="text" class="grey-input" placeholder="{% trans "Project name" %}" name="q" aria-label="{% trans "Project name" %}" value="{{ query }}" />
                <input type="submit" class="button button-med-120 inline border rev" value="{% trans "Search" %}" />
              </form>
            </div>

            <div class="articles archive">
              {% for service in discoverable_services %}
                <div class="article" id="d{{ service.pk }}">
                  <div class="img">
                    <a href="{{ service.site_url }}">
                      <img class="discover-img" src="{% if service.discover_image %}{{ service.discover_image.url }}{% else %}{{ service.site_url }}/exports/og.png{% endif %}" />
                    </a>
                  </div>
                  <div class="content">
                    <h2><a href="{{ service.site_url }}" lang="en" dir="ltr">{{ service.site_title }}</a></h2>
                    {% with projects=service.project_set.all %}
                      <div class="date">
                          {% blocktrans count count=projects|length %}{{ count }} project{% plural %}{{ count }} projects{% endblocktrans %}
                      </div>
                      {% if service.discover_text %}
                        <p lang="en" dir="ltr">{{ service.discover_text }}</p>
                      {% endif %}
                      <p lang="en" dir="ltr">
                        {% if service.matched_projects %}
                          {% for project in service.matched_projects %}
                            <a href="{{ service.site_url }}{{ project.url }}">{{ project.name }}</a>
                          {% endfor %}
                          {% if service.non_matched_projects_count %}
                            {% blocktrans count count=service.non_matched_projects_count %}…and {{ count }} more{% plural %}…and {{ count }} more{% endblocktrans %}
                          {% endif %}
                        {% else %}
                          {% for project in service.project_set.all|slice:":20" %}
                            <a href="{{ service.site_url }}{{ project.url }}">{{ project.name }}</a>
                          {% endfor %}
                          {% if projects|length > 20 %}
                            {% blocktrans count count=projects|length|add:-20 %}…and {{ count }} more{% plural %}…and {{ count }} more{% endblocktrans %}
                          {% endif %}
                        {% endif %}
                      </p>
                    {% endwith %}
                  </div>
                </div>
              {% empty %}
                <h2 id="which" class="section-title payment-conditions">{% trans "No servers matched your search." %}</h2>
              {% endfor %}
            </div>
        </div>
    </div>
</section>

{% endblock %}
